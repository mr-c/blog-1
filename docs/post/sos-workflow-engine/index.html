<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en-us">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    
<title>SoS: a cure to pipelineitis (under development) | vatlab</title>

<meta property='og:title' content='SoS: a cure to pipelineitis (under development) - vatlab'>
<meta property='og:description' content='Because of the needs to use libraries and tools in different languages and to execute them on different systems such as clusters, bioinformaticians write a lot of scripts in different languages and face many chanllenges in developing, running, managing, sharing, and reproducing bioinformatic data analyses. Notably,
 Management of scripts: With increasing number of scripts, some in multiple versions, some shared among projects, some written for and executed on remote systems, it can be difficult to share data analysis with others, and reproduce prior data analyses later on.'>
<meta property='og:url' content='https://vatlab.github.io/blog/post/sos-workflow-engine/'>
<meta property='og:site_name' content='vatlab'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/969c44b6bc34a74a2f1d1dc59ddaa98f?s=256'><meta property='article:section' content='Post'><meta property='article:tag' content='SoS'><meta property='article:tag' content='Workflow'><meta property='article:published_time' content='2017-12-15T00:00:00Z'/><meta property='article:modified_time' content='2017-12-15T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@ScriptOfScripts'><meta name='twitter:creator' content='@ScriptOfScripts'>
<link rel="stylesheet" href="https://vatlab.github.io/blog//css/style.css"/><link rel='stylesheet' href='https://vatlab.github.io/blog/css/custom.css'></head>
<body>

<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="https://vatlab.github.io/blog/"><h1 class="title is-4">vatlab
			   </h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile"><a class="level-item" href='mailto:bpeng@mdanderson.org' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" href='https://github.com/vatlab' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" href='https://twitter.com/ScriptOfScripts' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <div class="subtitle is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="https://vatlab.github.io/blog/tags/sos">#SoS</a>



  
  | <a class="subtitle is-6" href="https://vatlab.github.io/blog/tags/workflow">#Workflow</a>
  

      
    </div>
    <h2 class="subtitle is-6">December 15, 2017</h2>
    <h1 class="title">SoS: a cure to pipelineitis (under development)</h1>
      
    <div class="content">
      

<p>Because of the needs to use libraries and tools in different languages and to execute them on
different systems such as clusters, bioinformaticians write a lot of scripts in different languages
and face many chanllenges in developing, running, managing, sharing, and reproducing bioinformatic
data analyses. Notably,</p>

<ol>
<li><strong>Management of scripts</strong>: With increasing number of scripts, some in multiple versions, some shared
among projects, some written for and executed on remote systems, it can be difficult to share data
analysis with others, and reproduce prior data analyses later on.</li>
<li><strong>Analyze large datasets</strong>: It is tedious and error-prone to write scripts to analyze larger and larger
amount of data as more and more work is needed for the &ldquo;execution&rdquo; part of the analysis, such as
submit and monitor jobs, and collect results.</li>
</ol>

<h2 id="why-workflow-systems-are-not-used-in-daily-computational-research">Why workflow systems are not used in daily computational research</h2>

<p>Scientific pipeline systems are designed to streamline and execute workflows so they are supposed to
help alleviate these problems. However, <strong>although everyone knows the benefits of workflow systems,
everyone has heard of and talks about the power and popularity of some workflow systems, no one I
know actually uses a workflow system for daily computational research.</strong> I was puzzled by this
phenomina but, after surveying all <a href="https://github.com/pditommaso/awesome-pipeline" target="_blank">100+ workflow systems</a> and trying
more than 10 of them, I realized that <strong>the overhead of applying a workflow system in daily data
analysis is too high to help productivity</strong>.
As a matter of fact, as pointed out by <a href="https://www.nature.com/articles/nbt.2740" target="_blank">Loman and Watson, 2013, Nat Biotechnol</a>,
using a workflow system for analyses that will be run only once, or not meant to be shared with or repeated
by others can decrease creativity and productivity.</p>

<blockquote>
<h4 id="pipelineitis-is-a-nasty-disease">Pipelineitis is a nasty disease</h4>

<p>A pipeline is a series of steps, or software tools, run in sequence according to a predefined plan.
Pipelines are great for running exactly the same set of steps in a repetitive fashion, and for
sharing protocols with others, but <strong>they force you into a rigid way of thinking and can decrease creativity</strong>.</p>

<p>Warning: <strong>donâ€™t pipeline too early</strong>. Get a method working before you turn it into a pipeline. And
even then, does it need to be a pipeline? Have you saved time? Is your pipeline really of use to
others? If those steps are only ever going to be run by you, then a simple script will suffice and
<strong>any attempts at pipelining will simply waste time</strong>. Similarly, if those steps will only ever be run
once, just run them once, document the fact you did so and move on.</p>
</blockquote>

<h2 id="pipelineitis-is-a-treatable">Pipelineitis is a treatable</h2>

<p>Pipelineitis is a nasty disease but admiting the facts does not save us from all the aforementioned problems
we have in daily data analysis. Looking over and over at the key obstacles that prevent the application of
workflow systems in daily computational research, we developed <a href="https://vatlab.github.io/sos-docs/" target="_blank">SoS (Script of Scripts)</a>,
which is a workflow engine with a multi-language notebook frontend, to treat pipelineitis.
The following table summarizes the major features of SoS and how they can help the application of
workflow systems in daily computational research:</p>

<table>
<thead>
<tr>
<th>Symptom</th>
<th>Cause</th>
<th>Treatment</th>
</tr>
</thead>

<tbody>
<tr>
<td><strong>Lower productivity</strong></td>
<td>Re-create data analysis using another language or environment</td>
<td><ul><li>A <a href="https://vatlab.github.io/blog/post/sos-notebook/">single environment</a> for both interactrive data analysis and batch data processing</li><li><a href="https://vatlab.github.io/blog/post/power-of-sos-plus-sos-notebook/">Easy transition</a> from notebook to workflow</li></ul></td>
</tr>

<tr>
<td><strong>Steep learnin curve</strong></td>
<td>Workflow language difficult to learn and use, making it difficult to adopt</td>
<td><ul><li>Workflow as &ldquo;annotations&rdquo; to Python scripts</li><li>Trivial to get started, grow as needed</li></ul></td>
</tr>

<tr>
<td><strong>Difficult to read and share</strong></td>
<td>Data analysis logics (core steps)<ul><li>buried in execution logics</li><li>or written in foreign workflow language</li><li>or hidden behind workflow GUI</li></ul></td>
<td><ul><li>Almost verbatim inclusion of scripts</li><li>Simple workflow directives</li><li>Single multi-language notebook with annotated workflow</li></ul></td>
</tr>

<tr>
<td><strong>Difficult to reproduce</strong></td>
<td>Data analysis scattered in multiple scripts for multiple systems</td>
<td><ul><li>Ability to execute entire or parts of workflows remotely</li><li>Keep local and remote tasks in one notebook</li></ul></td>
</tr>
</tbody>
</table>

<h2 id="an-ide-for-both-interactive-data-analysis-and-workflow-development">An IDE for both interactive data analysis and workflow development</h2>

<p>A complex workflow inevitably involves scripts in multiple languages. Existing workflow systems generally
do not provide an interactive environment for the development of these scripts. Even for workflow systems
that provide nice GUIs, the graphical interfaces are used to construct workflows from mature scripts, not
for the development of workflow steps. Consequently, users are required to develop workflow steps in
other environments before wrapping them to a workflow system.</p>

<p><strong>SoS Notebook is a multi-language IDE for the SoS workflow engine</strong> that provides an interactive
environment for all stages of workflow development. As demonstrated in blog
posts <a href="https://vatlab.github.io/blog/post/sos-notebook/" target="_blank">SoS Notebook: One Notebook, Multiple Kernels</a> and
<a href="https://vatlab.github.io/blog/post/power-of-sos-plus-sos-notebook/" target="_blank">Combined power of SoS and SoS Notebook</a>,
SoS Notebook allows you to:</p>

<ul>
<li>Develop scripts in different languages using multiple kernels,
with added features such as string interpolation
(magic <a href="https://vatlab.github.io/sos-docs/doc/documentation/SoS_Magics.html#magic-expand" target="_blank">%expand</a>)
and line-by-line execution.</li>
</ul>

<p><img src="https://vatlab.github.io/sos-docs/doc/media/step_through.gif" alt="step through" /></p>

<ul>
<li><p>Convert scripts to SoS &ldquo;actions&rdquo; to be executed as (scratch) workflow steps. The &ldquo;actions&rdquo;
are Python functions and can be debugged in the SoS kernell</p></li>

<li><p>&ldquo;Chain&rdquo; the scratch workflow steps into SoS workflows by adding <code>input</code>, <code>output</code>, <code>depends</code>
statements and section headers.</p></li>
</ul>

<p><img src="https://vatlab.github.io/sos-docs/doc/media/SoS_Workflow.gif" alt="SoS notebook with SoS" /></p>

<p><strong>The SoS environment makes it easy to convert scripts developed in interactive
data analysis to a workflow</strong> which removes the biggest obstacle in the utilization
of workflows in daily computational reserach.</p>

<h2 id="workflow-syntax-as-annotations-to-python-scripts">Workflow syntax as &ldquo;annotations&rdquo; to Python scripts</h2>

<p>SoS is extended from Python 3.6 so <strong>a SoS script is essentially a Python script with
additional workflow specifications</strong>. The SoS syntax is very simple and can be summarized
as follows:</p>

<table>
<thead>
<tr>
<th>Syntax</th>
<th>Example</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>Script format of function call</td>
<td><pre>sh:<br>  echo &ldquo;I am sh&rdquo;</pre></td>
<td>Calling a Python function with multi-line script as first parameter</td>
</tr>

<tr>
<td>Section header</td>
<td><pre>[step_10]</pre></td>
<td>Define workflow steps</td>
</tr>

<tr>
<td>Parameter definition</td>
<td><pre>parameter: cutoff=5</pre></td>
<td>Define command line argument</td>
</tr>

<tr>
<td>Step input, output, and depends</td>
<td><pre>input: &ldquo;a.txt&rdquo;</pre></td>
<td>Define input, output, and dependent targets of steps</td>
</tr>

<tr>
<td>Task</td>
<td><pre>task: walltime=&lsquo;24h&rsquo;</pre></td>
<td>Define external tasks</td>
</tr>
</tbody>
</table>

<p>As shown in the following figure, a SoS workflow can be created as verbatim inclusion of
scripts in different languages. The script can be annotated with additional workflow
syntax to make use of more and more workflow features such as runtime signature and
external execution of tasks, but the workflow remains readable because the key parts
of the workflow, namely the included scripts, remain largely untouched.</p>

<p><img src="https://vatlab.github.io/sos-docs/doc/media/sos_syntax.gif" alt="SoS notebook with SoS" /></p>

<p>The following videos describes these steps in detail:</p>

<table style="border:0px">
<tr>
<td style="border:0px"><iframe width="373" height="210" src="https://www.youtube.com/embed/E5Eh7BVbbTM" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe>
</td>
<td style="border:0px"><iframe width="373" height="210" src="https://www.youtube.com/embed/roTDvSXSPgU" frameborder="0" gesture="media" allow="encrypted-media" allowfullscreen></iframe></td>
</tr>
</table>

<p>It worth mentioning that SoS supports both forward-style procedure-oriented and
makefile-style outcome-oriented workflows. The forward-style workflows are specified
as numerically ordered steps that will be executed sequentially (logically speaking),
and makefile-style workflows are specified as steps that provides targets that are
used by others.</p>

<h2 id="remote-execution-made-easy">Remote execution made easy</h2>

<p>Showing task list.</p>

<p>Point to single notebook with local and remote scripts</p>

<p><small>
SoS Notebook is currently implemented as a Jupyter kernel but we will certainly port it to JupyterLab after JupyterLab matures
(<a href="https://github.com/jupyterlab/jupyterlab/issues/2815" target="_blank">JupyterLab/2815</a>).
More details of SoS and SoS Notebook can be found at the <a href="https://vatlab.github.io/sos-docs/" target="_blank">SoS website</a> where you can
find tons of documentations, tutorials, examples, and youtube videos. Please test SoS Notebook and send
your feedback and/or bug reports to our <a href="https://github.com/vatlab/sos-notebook/issues" target="_blank">github issue tracker</a>.
If you find SoS Notebook useful, please support the project by starring the <a href="https://github.com/vatlab/SoS" target="_blank">SoS</a> and
<a href="https://github.com/vatlab/sos-notebook" target="_blank">SoS Notebook</a>
github projects, or spreading the word with <a href="https://twitter.com/ScriptOfScripts" target="_blank">twitter</a>. </small></p>

    </div>
    
  </div>
</section>



<section class="section">
  <div class="container">
<div id="gh-comments">
    <br/><br/>
    <h5>COMMENTS</h5>
    <div id="gh-comments-list"></div>
    <a href="javascript:void(0)" id="gh-load-comments" class="btn" style="display:none">Load more comments</a>
</div>

<script type="text/javascript" src="https://vatlab.github.io/blog/js/github-comments.js"></script>
<script type="text/javascript">
    DoGithubComments( 8 );
</script>
      
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; <a href="https://faculty.mdanderson.org/profiles/bo_peng.html">Bo Peng, Ph.D. / MD Anderson Cancer Center</a> All rights reserved</p>
    
  </div>
</section>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-107286198-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


</body>
</html>
